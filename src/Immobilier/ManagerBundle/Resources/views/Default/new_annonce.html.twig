{% extends 'ImmobilierManagerBundle::layout.html.twig' %}
{# src/Acme/TaskBundle/Resources/views/Default/new_gov.html.twig #}

{% block content %}
<div id="content">
    <div class="container">
        <div>
            <div id="main">
                <div class="list-your-property-form">
                    <h2 class="page-header">List your property</h2>

                    <div class="content">
                        <div class="row">
                            <div class="span8">
                                <p>
                                    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam ullamcorper libero sed ante auctor vel gravida nunc placerat. Suspendisse molestie posuere sem, in viverra dolor venenatis sit amet. Aliquam gravida nibh quis justo pulvinar luctus. Phasellus a malesuada massa.
                                </p>
                            </div><!-- /.span8 -->
                        </div><!-- /.row -->

                        <form method="post" action="" enctype="multipart/form-data">
                            <div class="row">
                                <div class="span4">
                                    <h3><strong>1.</strong> <span>Personal info</span></h3>

                                    <div class="control-group">
                                        <label class="control-label" for="inputPropertyFirstName">
                                            First name
                                            <span class="form-required" title="This field is required.">*</span>
                                        </label>
                                        <div class="controls">
                                            <input type="text" name="name" id="inputPropertyFirstName">
                                        </div><!-- /.controls -->
                                    </div><!-- /.control-group -->

                                    <div class="control-group">
                                        <label class="control-label" for="inputPropertySurname">
                                            Surname
                                            <span class="form-required" name="prenom" title="This field is required.">*</span>
                                        </label>
                                        <div class="controls">
                                            <input type="text" id="inputPropertySurname">
                                        </div><!-- /.controls -->
                                    </div><!-- /.control-group -->

                                    <div class="control-group">
                                        <label class="control-label" for="inputPropertyEmail">
                                            Email
                                            <span class="form-required" title="This field is required.">*</span>
                                        </label>
                                        <div class="controls">
                                            <input type="text" name="email" id="inputPropertyEmail">
                                        </div><!-- /.controls -->
                                    </div><!-- /.control-group -->

                                    <div class="control-group">
                                        <label class="control-label" for="inputPropertyPhone">
                                            Phone
                                            <span class="form-required" title="This field is required.">*</span>
                                        </label>
                                        <div class="controls">
                                            <input type="text" name="tel" id="inputPropertyPhone">
                                        </div><!-- /.controls -->
                                    </div><!-- /.control-group -->
                                </div><!-- /.span4 -->
                                <div class="span4">
                                    <h3><strong>2.</strong> <span>Property info</span></h3>
                                    <div class="control-group">
                                        <label class="control-label" for="inputTitle">
                                            Title
                                            <span class="form-required" title="This field is required.">*</span>
                                        </label>
                                        <div class="controls">
                                            <input type="text" name="title" id="inputTitle">
                                        </div><!-- /.controls -->
                                    </div><!-- /.control-group -->
                                    <div class="property-type control-group">
                                        <label class="control-label" for="{{ form.idPays.vars.id }}">
                                            Location
                                            <span class="form-required" title="This field is required.">*</span>
                                        </label>
                                        <div class="controls">
                                            {{ form_widget(form.idPays,{'attr':{'class':'test' }}) }}
                                        </div><!-- /.controls -->
                                    </div><!-- /.control-group -->
                                    <div class="contract-type control-group">
                                        <label class="control-label" for="{{ form.idCategory.vars.id }}">
                                            Category
                                            <span class="form-required" title="This field is required.">*</span>
                                        </label>
                                        <div class="controls">
                                            {{ form_widget(form.idCategory) }}
                                        </div><!-- /.controls -->
                                    </div><!-- /.control-group -->
                                    <div class="property-type control-group">
                                        <label class="control-label" for="{{ form.idType.vars.id }}">
                                            Type
                                            <span class="form-required" title="This field is required.">*</span>
                                        </label>
                                        <div class="controls">
                                           {{ form_widget(form.idType) }}
                                        </div><!-- /.controls -->
                                    </div><!-- /.control-group -->

                                    <div class="contract-type control-group">
                                        <label class="control-label" for="{{ form.nature.vars.id }}">
                                            Nature
                                            <span class="form-required" title="This field is required.">*</span>
                                        </label>
                                        <div class="controls">
                                            {{ form_widget(form.nature) }}
                                        </div><!-- /.controls -->
                                    </div><!-- /.control-group -->
                                    <div class="area control-group">
                                        <label class="control-label" for="{{ form.surface.vars.id }}">
                                            Area
                                            <span class="form-required" title="This field is required.">*</span>
                                        </label>
                                        <div class="controls">
                                            {{  form_widget(form.surface ) }}
                                        </div><!-- /.controls -->
                                    </div><!-- /.control-group -->

                                    <div class="price control-group">
                                        <label class="control-label" for="{{ form.prix.vars.id }}">
                                            Price
                                            <span class="form-required" title="This field is required.">*</span>
                                        </label>
                                        <div class="controls">
                                            {{ form_widget(form.prix,{'attr':{'id':'inputPropertyPrice'}} ) }}
                                        </div><!-- /.controls -->
                                    </div><!-- /.control-group -->
                                </div><!-- /.span4 -->
                            </div>
                            <div class="row">
                                <div class="span4">
                                    <h3><strong>4.</strong> <span>Location of the property</span></h3>
                                    <div class="control-group">
                                        <label class="control-label" for="{{ form.latlng.vars.id }}">
                                            Your location in the map
                                            <span class="form-required" title="This field is required.">*</span>
                                        </label>
                                        <div class="controls">
                                            {#<textarea id="inputPropertyNotes"></textarea>#}
                                            {{ form_widget(form.latlng ) }}
                                        </div><!-- /.controls -->
                                    </div><!-- /.control-group -->
                                    <div class="control-group">
                                        <div class="controls">
                                            {{ form_widget(form._token) }}
                                        </div><!-- /.controls -->
                                    </div><!-- /.control-group -->
                                </div><!-- /.span4 -->
                                <div class="span4">
                                    <h3><strong>3.</strong> <span>Image upload</span></h3>

                                    <div class="fileupload control-group">
                                        <label class="control-label" for="inputPropertyPrice">
                                            Image files
                                        </label>
                                        {{ form_widget(form.photos) }}
                                    </div><!-- .fileupload -->

                                    <div class="control-group">
                                        <label class="control-label" for="{{ form.description.vars.id }}">
                                            Your notes
                                            <span class="form-required" title="This field is required.">*</span>
                                        </label>
                                        <div class="controls">
                                            {#<textarea id="inputPropertyNotes"></textarea>#}
                                            {{ form_widget(form.description ) }}
                                        </div><!-- /.controls -->
                                    </div><!-- /.control-group -->
                                    <div class="control-group">
                                        <div class="controls">
                                            <input  class="btn btn-primary arrow-right" type="submit" value="send">
                                        </div><!-- /.controls -->
                                    </div><!-- /.control-group -->
                                </div><!-- /.span4 -->
                            </div><!-- /.row -->
                        </form>
                    </div><!-- /.content -->
                </div><!-- /.list-your-property-form -->
            </div>
        </div>
    </div>
</div><!-- /#content -->
        {#{ form(form) }#}
        {#
        <h2>Creer un nouveau annonce</h2>
        {{ form_start(form) }}
            {{ form_errors(form) }}
            {{ form_row(form.idPays) }}
            {{ form_row(form.idCategory) }}
            {{ form_row(form.idType) }}
            {{ form_row(form.nature) }}
            {{ form_row(form.surface) }}
            {{ form_row(form.prix) }}

            {{ form_rest(form) }}
            <input type="submit" value="Send" class="symfony-button-grey" />
        {{ form_end(form) }}
        #}


{% endblock %}
{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript" src="{{ asset('bundles/ohgooglemapformtype/js/jquery.ohgooglemaps.js') }}"></script>
    {# javascripts '@OhGoogleMapFormTypeBundle/Resources/public/js/jquery.ohgooglemaps.js' %}
        <script type="text/javascript" src="{{ asset_url }}"></script>
    {% endjavascripts #}
    <script type="text/javascript">
        var $collectionHolder;

        // setup an "add a tag" link
        var $addTagLink = $('<span class="add_photo_link fileupload-new">Add a file</span>');
        var $newLinkLi = $('<span class="btn btn-file"></span>').append($addTagLink);

        jQuery(document).ready(function() {
            // Get the ul that holds the collection of tags
            $('#annonce_photos').attr('data-prototype',
                    '<div class="uneditable-input">'+
                            '<i class="icon-file fileupload-exists"></i>'+
                            '<span class="fileupload-preview"></span>'+
                            '</div>'+
                            '<span class="btn btn-file">'+
                            '<span class="fileupload-new">Select file</span>'+
                            '<span class="fileupload-exists">Change</span>'+
                            '<input type="file" id="annonce_photos___name__" name="annonce[photos][__name__]"    class="file-box">'+
                            '</span>'+
                            '<a href="#" class="btn fileupload-exists" data-dismiss="fileupload">Remove</a>'
            );
            $collectionHolder = $('#annonce_photos');

            // add the "add a tag" anchor and li to the tags ul
            $collectionHolder.after($newLinkLi);

            // count the current form inputs we have (e.g. 2), use that as the new
            // index when inserting a new item (e.g. 2)
            $collectionHolder.data('index', $collectionHolder.find(':input').length);

            $addTagLink.on('click', function(e) {
                // prevent the link from creating a "#" on the URL
                e.preventDefault();

                // add a new tag form (see next code block)
                addTagForm($collectionHolder, $newLinkLi);
            });
        });
        function addTagForm($collectionHolder, $newLinkLi) {
            // Get the data-prototype explained earlier
            var prototype = $collectionHolder.data('prototype');

            // get the new index
            var index = $collectionHolder.data('index');

            // Replace '__name__' in the prototype's HTML to
            // instead be a number based on how many items we have
            // var newForm = prototype.replace(/__name__label__/g, 'Image'+index);
            var newForm = prototype.replace(/__name__/g, index);

            // increase the index with one for the next item
            $collectionHolder.data('index', index + 1);

            // Display the form in the page in an li, before the "Add a tag" link li
            var $newFormLi = $('<div class="fileupload fileupload-new input-append" data-provides="fileupload"></div>').append(newForm);
            $newLinkLi.before($newFormLi);
        }
    </script>
{% endblock %}
